
\begin{abstract}
  Population dynamics are generally modelled without taking behavior into account. This in spite of the largest daily feeding times for predators, namely at dawn and dusk, being driven by behavior. The daily pattern stems from the Diel Vertical Migration (DVM) in the aquatic setting and crepuscular behavior in the terrestrial setting. This is usually explained by prey avoiding visual predators, and visual predators seeking to find prey. We develop a game-theoretical model of predator-prey interactions in continuous time and space, finding the Nash equilibrium at every instant. By unifying results for the general resolution of polymatrix games, and a spectral discretization scheme, we can resolve the spatially continuous game nearly instantaneously. Our approach allows a unified model for the slow time-scale of population dynamics, and the fast time-scale of the vertical migration, under seasonal changes. We use the diel vertical migration as a case, examining emergent phenomena from the introduction of the fast dynamics.
  On the behaviorial time-scale, we see the emergence of a deep scattering layer from the game dynamics. On the longer time-scale of population dynamics, the introduction of optimal behavior has a strong stabilizing effect, compared to the model without optimal behavior. In a changing seasonal environment, we observe a change in daily migration patterns throughout the seasons, driven by changes in both population and light levels. The framework we propose can easily be adapted to population games in inhomogenous terrestrial environments, and more complex food-webs.
\end{abstract}

\section{Introduction}

Population dynamical models are generally founded on the implicit assumption of constant behavior, whether it be a model of predator-prey interactions assuming encounter rates only depending on the population levels \todo{Indsæt gerne et par referencer.} and interaction constants, or intra-species population models neglecting mating competitions.\todo{Den sidste hentydning forstår jeg ikke - reference?}

In nature, population dynamics emerge from behavior of the animals, with predator-prey encounters ruled by foraging behavior and population growth stemming from mating choices and nurture \todo{? Du skulle vel ikke have en personlig bias her, vel?}  behavior. In the past 50 years, game theory has evolved into an invaluable tool for studying animal behavior, giving a greatly expanded theoretical toolkit for understanding natural observed behavior and making predictions for how behavior will change based on external changes. Game theory has been used to model a wide variety of situations where an animal needs to make a choice, from habitat-choice, \citep{krivan1997dynamic}, mating behavior  \citep{rapoport1967exploiter}, and confrontation startegies \citep{smith1973logic}, for a general account see \citep{broom2013game}. The game theoretical models have been widely succesful, with empirical evidence backing up their validity as a model of animal behavior, \citep{cooper1989communication,empirical_trait,behaviorial_effects}. Recently, game theoretical models have succesfully been used to describe habitat selection games in continuous time and space, \citep{jerome,verticalmigration}, but these models were still constructed in a fashion where incorporating population dynamics was infeasible.

 There are notable exceptions to the rule of population models neglecting behavior, \citep{Krivan1998,genkai2007macrophyte, sadowski2019predator, cressman2010ideal,}, but the approach used in these models is not scalable to larger number of species or habitats. Instead, when considering population dynamics in large systems and trying to take behavior into account, a common approach is to use heuristics to incorporate behavior, \citep{ho2019predation}. This leads to situations where the diel vertical migration is modelled as a non-emergent phenomenom \citep{van2018global} 
\todo{indsæt up-to-date afsnit}
both in the case of staggered migrations and of  Vinogradov's ladder, where multiple layers of the oceanic community migrate. This is problematic for a realistic model of marine population dynamics, since the behaviorially driven diel vertical migration acts a driver of ocean population dynamics, with a majority of predator-prey interactions taking place at dusk and dawn in the mixed layer,  \citep{benoit2014critical}. When considering ecosystems, it is common to simplify the model by only considering one or two trophic levels, and in general most games that are applied in ecology only consider two players. This is in despite of eg. mating behavior being influenced by the risk of predation, \citep{carranza1999red,lima2009predators}, naturally leading to a game with at least three players. Recently games with larger numbers of players have been studied, \citep{pinti2019trophic}, able to explain important and hard-to-explain ecological phenomena, eg. vertical migrations going in counter phase.

Population models in continuous space with multiple trophic levels or roles are generally hard to examine numerically, as finding Nash equilibria in the resulting games is often prohibitely expensive in computational power, \citep{empirical_trait,abrams2010implications,pinti2019trophic}. We believe that a general framework allowing the incorporation of behavior in models of population dynamics is long overdue.

Players in game-theoretical models are usually seen as perfectly rational, acting on perfect state information. This seems unreasonable, as animals do not have perfect state information. In addition the minor gain in fitness from the almost-perfect choice to the perfect choice seems like it would be outweighed by the higher cognitive or sensorial cost of finding the perfect strategy.

\todo[inline]{Det ovenstående afsnit kan vel fjernes; det duplikeres stort set i det nedenstående?}

A common point of critique of game-theoretical models is that they assume all actors have perfect information and act in a perfectly rational manner, \citep{jones1999bounded}, acting on perfect state information. This seems unreasonable, as animals do not have perfect state information. In addition the minor gain in fitness from the almost-perfect choice to the perfect choice seems like it would be outweighed by the higher cognitive or sensorial cost of finding the perfect strategy.
Though these concerns are well-founded, most models end up incorporating perfect rationality and information anyway. When introducing uncertainty or bounded rationality, some attemps have been made to incorporate uncertainty in the theory of optimal foraging, \citep{bayesianmodel, thuijsman1995automata,gigerenzer2001rethinking}, the complexity has prevented the models from being implemented at the population level.

In this paper we present a new modelling\todo{I hvilket omfang er det en ``modelling approach'' vs. en ``numerical framework''?}  approach for incorporating game theory into population dynamics, illustrated with an application to the diel vertical migration. Our model is a modification of the model studied in \citep{verticalmigration}. Our basic approach is to rephrease a continuous habitat selection game as a single linear complementarity problem, \citep{miller1991copositive}, which can solved efficiently. The approach we propose can readily be applied to any polymatrix game, as well as any multi-agent game in continuous space. In essence, our approach provides a unified framework for examining the population and behavorial time-scales.  Unifying \todo{mon ikke ``coupling'' er et bedre ord end unifying? De vedbliver trods alt med at være ret forskellige. Forslag: Couplig these two very different time scales ...} the two time-scales allows us to examine how the vertical distribution of predators and prey change throughout the seasons and how this influences the population dynamics. We investigate the length and magnitude of the feeding rates of predators and consumers at dusk and dawn in spring, summer and autumn. In this way we model a the population dynamics associated to a single spawning cycle, and do not need to take ontogenics into account. \todo{Hmm. Argumentet her har en svaghed, har det ikke? Altså, hvis vi f.eks. ser på en kohorte, så vokser den netop gennem året?}

\todo[inline]{Fremhæv tre budskaber: 1) Computational polymatrix 2) Diskretisering 3) Støj}

We incorporate the feature of bounded rationality in our model by letting the animals maximize an expectation value with respect to their strategy, and letting their strategy incorporates noise. This allows us to examine how the optimal behavior with noise differs from that without noise, and how it changes the population dynamics. Again, this is feasible due to the numerical scheme we have chosen to examine the system. A change away from full rationality is expected to impact the fitness negatively, but it is unclear by how much. We examine this by looking at the population dynamics for the fully rational organisms compared to those with bounded rationality. As a baseline, we compare against the system with no behavorial optimization to see how the population dynamics evolve.




%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
