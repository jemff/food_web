
\begin{abstract}
  Population dynamics are often modeled without taking behavior into account. This is  in spite of the largest daily feeding times for predators, namely at dawn and dusk, being driven by behavior. The daily pattern stems from the Diel Vertical Migration (DVM) in the aquatic setting and crepuscular behavior in the terrestrial setting. This is usually explained by prey avoiding visual predators, and visual predators seeking to find prey. We develop a game-theoretical model of predator-prey interactions in continuous time and space, finding the Nash equilibrium at every instant. By unifying results for the general resolution of polymatrix games, and a spectral discretization scheme, we can resolve the spatially continuous game nearly instantaneously. Our approach allows a unified model for the slow time-scale of population dynamics, and the fast time-scale of the vertical migration, under seasonal changes. We use the diel vertical migration as a case, examining emergent phenomena from the introduction of the fast dynamics.
  On the behavioral time-scale, we see the emergence of a deep scattering layer from the game dynamics. On the longer time-scale of population dynamics, the introduction of optimal behavior has a strong stabilizing effect, compared to the model without optimal behavior. In a changing seasonal environment, we observe a change in daily migration patterns throughout the seasons, driven by changes in both population and light levels. The framework we propose can easily be adapted to population games in inhomogenous terrestrial environments, and more complex food-webs.
\end{abstract}

\todo[inline]{Abstracted skal nok skrives om til sidst.}

\section{Introduction}
Population dynamics emerges from behavior of the animals; yet many models of population dynamics and ecosystems ignore behavior.  In the past 50 years, game theory has evolved into an invaluable tool for for including animal behavior in ecological models. Game theory gives a theoretical toolkit for understanding observed behavior and making predictions for how behavior will change in response to external changes. Game theory has been used to model a wide variety of situations where an animal needs to make a choice, from habitat choice \citep{krivan1997dynamic, kondoh2003foraging,kvrivan2008ideal}, mating behavior  \citep{rapoport1967exploiter}, and confrontation strategies \citep{smith1973logic}. The game theoretical models have proven successful, with empirical evidence backing up their validity as a model of animal behavior \citep{cooper1989communication,empirical_trait,behavioral_effects}. Specifically, population games where the behavior is adapting instantaneously have emerged as a powerful tool to incorporate behavior in simple population models \citep{Krivan1998,genkai2007macrophyte, cressman2010ideal,pinti2021co, abrams2007role}. The approach used in these models is not scalable to larger number of species or continuous habitats.



Population games often simplified by only considering  one or two trophic levels, \citep{cressman2010ideal, abrams2007role, sadowski2019predator}. This is in spite of e.g. mating behavior being influenced by the risk of predation, \citep{carranza1999red,lima2009predators}, naturally leading to a game with at least three players. Going to games with larger number of players can explain complex phenomena, which cannot be modeled with only two types \citep{pinti2019trophic}. Natural habitats often have continuous fitness gradients \citep{kawecki2004conceptual}, yet population games typically simplify this complex to only a small finite number of patches, \cite{valdovinos2010consequences}. Population models in continuous space with multiple trophic levels or roles are generally hard to examine, as finding Nash equilibria in the resulting games is often prohibitively hard, \citep{empirical_trait,pinti2019trophic}. Resolving the issues of computing Nash equilibria quickly in a continuous setting allows the extension of population games to more realistic models. The question of whether to include behavior in a model or not becomes a question of relevance to the model rather than feasibility.


A critique of game-theoretical models is the assumption that players have perfect information and act in a perfectly rational manner, \citep{jones1999bounded}. Perfect information seems unreasonable, as animals do not have perfect state information \citep{simon1955behavioral}. In addition the minor gain in fitness from the almost-perfect choice to the perfect choice is often outweighed by the higher cognitive or sensorial cost of finding the perfect strategy \citep{simon1956rational, cohen2019bounded}. Though these concerns are well-founded, most models end up incorporating perfect rationality and information anyway. Classical satisficing models of bounded rationality cannot be verified empirically \citep{nonacs1993satisficing}, and with other attempts the \citep{bayesianmodel, thuijsman1995automata} the complexity has prevented the models from being implemented at the population level.



%When introducing uncertainty or bounded rationality, some attemps have been made to incorporate uncertainty in the theory of optimal foraging,

We introduce a method allowing the incorporation of behavior and imperfect decision making in  population games in continuous space and time. The approach we introduce can readily be applied to study multi-species population dynamics emerging from a habitat-choice game in both continuous and discrete habitats. We apply the method to the diel vertical migration. During the day billions of small fish and zoo-plankton migrate from the upper layers of the ocean to the deeper, darker layers, which can be directly measured as the deep scattering layer, \citep{sutton2013vertical, wang2014seasonal}. At dusk, the small fish and zoo-plankton migrate upwards. We study the seasonal interplay between population dynamics and behavior. The model is an extension of the model studied in \citep{verticalmigration} to a population game. Our basic approach is to rephrase a continuous habitat selection game as a single linear complementarity problem, \citep{miller1991copositive}. We incorporate bounded rationality by requiring the strategies solve a diffusion equation, picking the strategy that maximizes the payoff with a given level of noise.
We couple the time scales of population dynamics and behavioral time scales, which allows us to examine how the vertical distribution of predators and prey change throughout the seasons and how this influences the population dynamics. We investigate the length and magnitude of the feeding rates of predators and consumers at throughout the day in spring, summer, and autumn of a single year. We examine how the optimal behavior with noise differs from that without noise, and how noise changes the population dynamics.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
